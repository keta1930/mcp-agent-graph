<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAG SDK 使用文档</title>
    
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="192x192" href="./favicon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon.png">
    <link rel="shortcut icon" href="./favicon.ico">
    
    <link href="https://cdn.staticfile.org/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://cdn.staticfile.org/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js 语法高亮 -->
    <link id="highlight-theme" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css" rel="stylesheet">
    
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --text-primary: #1a202c;
            --text-secondary: #4a5568;
            --text-muted: #718096;
            --border-color: #e2e8f0;
            --accent-primary: #3182ce;
            --accent-secondary: #63b3ed;
            --code-bg: #f7fafc;
            --sidebar-bg: #ffffff;
            --shadow-light: rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] {
            --bg-primary: #1a202c;
            --bg-secondary: #2d3748;
            --bg-tertiary: #4a5568;
            --text-primary: #f7fafc;
            --text-secondary: #e2e8f0;
            --text-muted: #a0aec0;
            --border-color: #4a5568;
            --accent-primary: #63b3ed;
            --accent-secondary: #90cdf4;
            --code-bg: #2d3748;
            --sidebar-bg: #2d3748;
            --shadow-light: rgba(0, 0, 0, 0.3);
        }

        * {
            font-family: Tahoma, Arial, Roboto, "Droid Sans", "Helvetica Neue", "Droid Sans Fallback", "Heiti SC", "Hiragino Sans GB", Simsun, sans-serif;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .sidebar {
            background-color: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            box-shadow: 4px 0 6px var(--shadow-light);
        }

        .content-area {
            background-color: var(--bg-primary);
        }

        .nav-item {
            color: var(--text-secondary);
            transition: all 0.2s ease;
            border-radius: 8px;
            margin: 2px 0;
        }

        .nav-item:hover {
            background-color: var(--bg-tertiary);
            color: var(--accent-primary);
            transform: translateX(4px);
        }

        .nav-item.active {
            background-color: var(--accent-primary);
            color: white;
            box-shadow: 0 2px 4px var(--shadow-light);
        }

        .code-block {
            background-color: var(--code-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            position: relative;
            transition: all 0.2s ease;
        }

        .code-block:hover {
            box-shadow: 0 4px 12px var(--shadow-light);
            transform: translateY(-1px);
        }

        .copy-btn {
            background-color: var(--accent-primary);
            color: white;
            transition: all 0.2s ease;
        }

        .copy-btn:hover {
            background-color: var(--accent-secondary);
            transform: scale(1.05);
        }

        .section-card {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .section-card:hover {
            box-shadow: 0 8px 25px var(--shadow-light);
            transform: translateY(-2px);
        }

        .theme-toggle {
            background-color: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            transition: all 0.2s ease;
        }

        .theme-toggle:hover {
            box-shadow: 0 2px 8px var(--shadow-light);
        }

        .collapse-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .collapse-content.expanded {
            max-height: 2000px;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .method-card {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .method-card:hover {
            border-color: var(--accent-primary);
            box-shadow: 0 4px 12px var(--shadow-light);
        }
    </style>
</head>
<body>
    <div class="flex h-screen overflow-hidden">
        <!-- 侧边栏 -->
        <div class="sidebar w-80 flex-shrink-0 overflow-y-auto">
            <div class="p-6">
                <!-- 标题 -->
                <div class="flex items-center justify-between mb-8">
                    <div>
                        <h1 class="text-2xl font-bold text-blue-600">MAG SDK</h1>
                        <p class="text-sm" style="color: var(--text-muted)">使用文档</p>
                    </div>
                    <!-- 主题切换按钮 -->
                    <button id="themeToggle" class="theme-toggle p-2 w-10 h-10 flex items-center justify-center">
                        <i class="fas fa-moon text-sm"></i>
                    </button>
                </div>

                <!-- 导航菜单 -->
                <nav class="space-y-2">
                    <!-- 快速开始 -->
                    <div class="nav-section">
                        <button class="nav-item w-full text-left px-4 py-3 flex items-center justify-between font-medium" onclick="toggleSection('quick-start')">
                            <span><i class="fas fa-rocket mr-2"></i>快速开始</span>
                            <i class="fas fa-chevron-down transition-transform" id="quick-start-icon"></i>
                        </button>
                        <div class="collapse-content pl-6" id="quick-start-content">
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('installation')">
                                <i class="fas fa-download mr-2"></i>安装部署
                            </a>
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('service-management')">
                                <i class="fas fa-cogs mr-2"></i>服务管理
                            </a>
                        </div>
                    </div>

                    <!-- 模型管理 -->
                    <div class="nav-section">
                        <button class="nav-item w-full text-left px-4 py-3 flex items-center justify-between font-medium" onclick="toggleSection('model-management')">
                            <span><i class="fas fa-brain mr-2"></i>模型管理</span>
                            <i class="fas fa-chevron-down transition-transform" id="model-management-icon"></i>
                        </button>
                        <div class="collapse-content pl-6" id="model-management-content">
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('model-add')">
                                <i class="fas fa-plus mr-2"></i>添加模型
                            </a>
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('model-list')">
                                <i class="fas fa-list mr-2"></i>列出模型
                            </a>
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('model-update')">
                                <i class="fas fa-edit mr-2"></i>更新模型
                            </a>
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('model-delete')">
                                <i class="fas fa-trash mr-2"></i>删除模型
                            </a>
                        </div>
                    </div>

                    <!-- MCP管理 -->
                    <div class="nav-section">
                        <button class="nav-item w-full text-left px-4 py-3 flex items-center justify-between font-medium" onclick="toggleSection('mcp-management')">
                            <span><i class="fas fa-server mr-2"></i>MCP管理</span>
                            <i class="fas fa-chevron-down transition-transform" id="mcp-management-icon"></i>
                        </button>
                        <div class="collapse-content pl-6" id="mcp-management-content">
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('mcp-server')">
                                <i class="fas fa-plus-circle mr-2"></i>服务器管理
                            </a>
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('mcp-config')">
                                <i class="fas fa-cog mr-2"></i>配置管理
                            </a>
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('mcp-connect')">
                                <i class="fas fa-link mr-2"></i>连接管理
                            </a>
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('mcp-tools')">
                                <i class="fas fa-tools mr-2"></i>工具管理
                            </a>
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('mcp-ai-generate')">
                                <i class="fas fa-magic mr-2"></i>AI生成MCP
                            </a>
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('mcp-test')">
                                <i class="fas fa-vial mr-2"></i>测试工具
                            </a>
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('mcp-ai-tools')">
                                <i class="fas fa-robot mr-2"></i>AI工具管理
                            </a>
                        </div>
                    </div>

                    <!-- 图管理 -->
                    <div class="nav-section">
                        <button class="nav-item w-full text-left px-4 py-3 flex items-center justify-between font-medium" onclick="toggleSection('graph-management')">
                            <span><i class="fas fa-project-diagram mr-2"></i>图管理</span>
                            <i class="fas fa-chevron-down transition-transform" id="graph-management-icon"></i>
                        </button>
                        <div class="collapse-content pl-6" id="graph-management-content">
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('graph-generate')">
                                <i class="fas fa-magic mr-2"></i>图生成
                            </a>
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('graph-view')">
                                <i class="fas fa-eye mr-2"></i>图查看
                            </a>
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('graph-run')">
                                <i class="fas fa-play mr-2"></i>图运行
                            </a>
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('graph-continue')">
                                <i class="fas fa-forward mr-2"></i>断点续传
                            </a>
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('graph-to-mcp')">
                                <i class="fas fa-code mr-2"></i>图转MCP
                            </a>
                        </div>
                    </div>

                    <!-- 会话管理 -->
                    <div class="nav-section">
                        <button class="nav-item w-full text-left px-4 py-3 flex items-center justify-between font-medium" onclick="toggleSection('conversation-management')">
                            <span><i class="fas fa-comments mr-2"></i>会话管理</span>
                            <i class="fas fa-chevron-down transition-transform" id="conversation-management-icon"></i>
                        </button>
                        <div class="collapse-content pl-6" id="conversation-management-content">
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('conversation-list')">
                                <i class="fas fa-list mr-2"></i>会话列表
                            </a>
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('conversation-get')">
                                <i class="fas fa-eye mr-2"></i>获取会话
                            </a>
                            <a href="#" class="nav-item block px-4 py-2 text-sm" onclick="showPage('conversation-attachments')">
                                <i class="fas fa-paperclip mr-2"></i>附件处理
                            </a>
                        </div>
                    </div>
                </nav>
            </div>
        </div>

        
        <!-- 主内容区域 -->
        <div class="content-area flex-1 overflow-y-auto">
            <div class="p-8">
                <!-- 安装部署页面 -->
                <div id="installation" class="page-content fade-in">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-download mr-3 text-blue-600"></i>安装部署
                    </h2>
                    
                    <div class="method-card p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4">通过 PyPI 安装（推荐）</h3>
                        <div class="code-block p-4 mb-4">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-medium" style="color: var(--text-muted)">Shell</span>
                                <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                    <i class="fas fa-copy mr-1"></i>复制
                                </button>
                            </div>
                            <pre><code class="language-bash">pip install mcp-agent-graph</code></pre>
                        </div>
                        
                        <h4 class="text-lg font-medium mb-2">获取示例代码</h4>
                        <div class="code-block p-4 mb-4">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-medium" style="color: var(--text-muted)">Shell</span>
                                <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                    <i class="fas fa-copy mr-1"></i>复制
                                </button>
                            </div>
                            <pre><code class="language-bash">git clone https://github.com/keta1930/mcp-agent-graph.git
cd mcp-agent-graph/sdk_demo</code></pre>
                        </div>
                    </div>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">使用 uv（推荐）</h3>
                        <div class="code-block p-4 mb-4">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-medium" style="color: var(--text-muted)">Shell</span>
                                <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                    <i class="fas fa-copy mr-1"></i>复制
                                </button>
                            </div>
                            <pre><code class="language-bash">git clone https://github.com/keta1930/mcp-agent-graph.git
cd mcp-agent-graph
uv sync
.venv\Scripts\activate.ps1  # PowerShell
.venv\Scripts\activate.bat  # CMD</code></pre>
                        </div>
                    </div>
                </div>

                <!-- 服务管理页面 -->
                <div id="service-management" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-cogs mr-3 text-blue-600"></i>服务管理
                    </h2>

                    <div class="method-card p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4">启动服务</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.start() -> bool</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">bool: 服务是否成功启动</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code class="language-python">import mag
mag.start()</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="method-card p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4">关闭服务</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.shutdown() -> None</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code class="language-python">mag.shutdown()</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">检查服务状态</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code class="language-python">mag.is_running() -> bool</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">bool: 服务是否正在运行</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code class="language-python">is_running = mag.is_running()
print(f"服务运行状态: {is_running}")</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 添加模型页面 -->
                <div id="model-add" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-plus mr-3 text-blue-600"></i>添加模型
                    </h2>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">mag.add_model()</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code class="language-python">mag.add_model(config: Dict[str, Any]) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>config</strong> (Dict): 模型配置，包含name、base_url、api_key、model字段</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, Any]: 操作结果</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code class="language-python">new_model = {
    "name": "deepseek-chat",
    "base_url": "https://api.deepseek.com",
    "api_key": "",
    "model": "deepseek-chat"
}
mag.add_model(new_model)</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 列出模型页面 -->
                <div id="model-list" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-list mr-3 text-blue-600"></i>列出模型
                    </h2>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">mag.list_models()</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code class="language-python">mag.list_models() -> List[Dict[str, Any]]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">List[Dict[str, Any]]: 模型配置列表</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code class="language-python">models = mag.list_models()
print(f"找到 {len(models)} 个模型")
for model in models:
    print(f"\n模型名称：{model['name']} \nBase_url：{model['base_url']}\n")</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 更新模型页面 -->
                <div id="model-update" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-edit mr-3 text-blue-600"></i>更新模型
                    </h2>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">mag.update_model()</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.update_model(name: str, config: Dict[str, Any]) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>name</strong> (str): 当前模型名称</li>
                                <li><strong>config</strong> (Dict): 更新后的模型配置</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, Any]: 操作结果</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>updated_model = {
    "name": "deepseek-chat",
    "base_url": "https://api.deepseek.com",
    "api_key": "",
    "model": "deepseek-chat"
}
result = mag.update_model("deepseek-chat", updated_model)
print(result)</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 删除模型页面 -->
                <div id="model-delete" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-trash mr-3 text-blue-600"></i>删除模型
                    </h2>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">mag.delete_model()</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.delete_model(name: str) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>name</strong> (str): 模型名称</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, Any]: 操作结果</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>mag.delete_model("deepseek-chat")</code></pre>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- MCP服务器管理页面 -->
                <div id="mcp-server" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-plus-circle mr-3 text-blue-600"></i>MCP服务器管理
                    </h2>

                    <div class="method-card p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4">添加服务器</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.add_server(servers: Dict[str, Any]) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>servers</strong> (Dict): 包含mcpServers的完整配置</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>servers = {"mcpServers": {
    "fetch": {
        "autoApprove": ["fetch"],
        "timeout": 60,
        "command": "uvx",
        "args": ["mcp-server-fetch"],
        "transportType": "stdio"
    },
    "memory": {
        "autoApprove": [],
        "timeout": 60,
        "command": "docker",
        "args": ["run", "-i", "-v", "claude-memory:/app/dist", "--rm", "mcp/memory"],
        "transportType": "stdio",
    }
}}
result = mag.add_server(servers=servers)
print(json.dumps(result, indent=4, ensure_ascii=False))</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">删除服务器</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.remove_server(names: Union[str, List[str]]) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>names</strong> (Union[str, List[str]]): 服务器名称或服务器名称列表</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>result = mag.remove_server(["fetch","memory"])
print(json.dumps(result, indent=4, ensure_ascii=False))</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- MCP配置管理页面 -->
                <div id="mcp-config" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-cog mr-3 text-blue-600"></i>MCP配置管理
                    </h2>

                    <div class="method-card p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4">更新配置</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.update_mcp_config(config: Dict[str, Any]) -> Dict[str, Dict[str, Any]]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>config</strong> (Dict): MCP配置，将替代之前的配置文件</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>config={
  "mcpServers": {
    "memory": {
      "autoApprove": [],
      "timeout": 60,
      "command": "docker",
      "args": ["run", "-i", "-v", "claude-memory:/app/dist", "--rm", "mcp/memory"],
      "transportType": "stdio",
    },
    "fetch": {
      "autoApprove": ["fetch"],
      "timeout": 60,
      "command": "uvx",
      "args": ["mcp-server-fetch"],
      "transportType": "stdio",
    },
    "tavily-mcp": {
      "command": "npx",
      "args": ["-y", "tavily-mcp@0.1.2"],
      "env": {
        "TAVILY_API_KEY": ""
      }
    }
  }
}
result = mag.update_mcp_config(config=config)
print(json.dumps(result, indent=4, ensure_ascii=False))</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">获取配置</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.get_mcp_config() -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, Any]: MCP配置</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>mcp_config = mag.get_mcp_config()
print(json.dumps(mcp_config, indent=8, ensure_ascii=False))</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- MCP连接管理页面 -->
                <div id="mcp-connect" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-link mr-3 text-blue-600"></i>MCP连接管理
                    </h2>

                    <div class="method-card p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4">连接服务器</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.connect_mcp(server_name: str) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>server_name</strong> (str): 服务器名称，使用"all"连接所有服务器</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code># 连接单个
mag.connect_mcp("tavily-mcp")

# 连接所有
result = mag.connect_mcp("all")
print(json.dumps(result, indent=2, ensure_ascii=False))</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="method-card p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4">断开连接</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.disconnect_mcp(server_name: str) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>server_name</strong> (str): 服务器名称</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code># 断开特定服务器
result = mag.disconnect_mcp("tavily-mcp")
print(f"断开结果: {result['status']}")

if result['status'] == 'disconnected':
    print(f"服务器 {result['server']} 已成功断开连接")
else:
    print(f"断开失败: {result.get('error', '未知错误')}")</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">获取状态</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.get_mcp_status() -> Dict[str, Dict[str, Any]]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, Dict[str, Any]]: 服务器状态字典</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>mcp_status = mag.get_mcp_status()
for server, status in mcp_status.items():
    print(f"\n{server}: {'已连接' if status.get('connected') else '未连接'}")
    print(f"{server}工具：{status.get('tools')}")
print(json.dumps(mcp_status, indent=4, ensure_ascii=False))</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- MCP工具管理页面 -->
                <div id="mcp-tools" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-tools mr-3 text-blue-600"></i>MCP工具管理
                    </h2>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">获取工具</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.get_tools() -> Dict[str, List[Dict[str, Any]]]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, List[Dict[str, Any]]]: 按服务器分组的工具信息</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>mcp_tools = mag.get_tools()
print(json.dumps(mcp_tools, indent=2, ensure_ascii=False))</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI生成MCP页面 -->
                <div id="mcp-ai-generate" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-magic mr-3 text-blue-600"></i>AI生成MCP
                    </h2>

                    <div class="method-card p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4">获取AI生成模板</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.get_mcp_prompt() -> Dict[str, str]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, str]: 包含模板内容和使用说明</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>template_info = mag.get_mcp_prompt()
print("模板内容:")
print(template_info["template"])
print("\n使用说明:")
print(template_info["note"])</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="method-card p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4">AI生成MCP工具</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.generate_mcp(requirement: str, model_name: str) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>requirement</strong> (str): MCP工具需求描述</li>
                                <li><strong>model_name</strong> (str): 使用的模型名称</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, Any]: 生成结果，包含工具名称、端口等信息</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>result = mag.generate_mcp(
    requirement="创建一个文件管理工具，能够列出目录内容、创建文件夹、删除文件等操作",
    model_name="deepseek-chat"
)

if result["status"] == "success":
    print(f"成功生成MCP工具: {result['tool_name']}")
    print(f"使用端口: {result['port']}")
    print(f"工具文件夹: {result['folder_name']}")
else:
    print(f"生成失败: {result['error']}")
    print(f"模型输出: {result.get('model_output', 'N/A')}")</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">手动注册MCP工具</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.register_mcp(folder_name: str, script_files: Dict[str, str], 
                readme: str, dependencies: str, port: Optional[int] = None) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>folder_name</strong> (str): 工具文件夹名称</li>
                                <li><strong>script_files</strong> (Dict[str, str]): 脚本文件字典，键为文件名，值为文件内容</li>
                                <li><strong>readme</strong> (str): README文件内容</li>
                                <li><strong>dependencies</strong> (str): 依赖项列表</li>
                                <li><strong>port</strong> (Optional[int]): 端口号，默认为None</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>script_files = {
    "main.py": """#!/usr/bin/env python3
import asyncio
from mcp.server.fastmcp import FastMCP

mcp = FastMCP("My Custom Tool")

@mcp.tool()
def hello_world(name: str) -> str:
    \"\"\"Say hello to someone\"\"\"
    return f"Hello, {name}!"

if __name__ == "__main__":
    mcp.run()
""",
    "requirements.txt": "fastmcp>=0.1.0"
}

result = mag.register_mcp(
    folder_name="my_custom_tool",
    script_files=script_files,
    readme="# My Custom Tool\n\nA simple hello world MCP tool.",
    dependencies="fastmcp>=0.1.0",
    port=9001
)

print(f"注册结果: {result}")</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- MCP测试页面 -->
                <div id="mcp-test" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-vial mr-3 text-blue-600"></i>测试MCP工具
                    </h2>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">测试工具调用</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.test_mcp(server_name: str, tool_name: str, params: Dict[str, Any] = None) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>server_name</strong> (str): 服务器名称</li>
                                <li><strong>tool_name</strong> (str): 工具名称</li>
                                <li><strong>params</strong> (Dict[str, Any], optional): 工具参数，默认为None</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, Any]: 测试结果，包含状态、结果、执行时间等信息</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code># 测试fetch工具
result = mag.test_mcp(
    server_name="fetch",
    tool_name="fetch",
    params={"url": "https://httpbin.org/json"}
)

print(f"测试状态: {result['status']}")
print(f"执行时间: {result.get('execution_time', 'N/A')}秒")

if result['status'] == 'success':
    print(f"工具结果: {result['result']}")
else:
    print(f"错误信息: {result['error']}")

# 测试不带参数的工具
simple_result = mag.test_mcp("memory", "list_memories")
print(f"简单测试结果: {simple_result}")</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI工具管理页面 -->
                <div id="mcp-ai-tools" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-robot mr-3 text-blue-600"></i>AI工具管理
                    </h2>

                    <div class="method-card p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4">列出AI生成的工具</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.list_ai_mcp() -> List[str]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">List[str]: AI生成的MCP工具名称列表</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>ai_tools = mag.list_ai_mcp()
print(f"找到 {len(ai_tools)} 个AI生成的MCP工具:")
for tool in ai_tools:
    print(f"- {tool}")

# 检查特定工具是否存在
if "file_manager_tool" in ai_tools:
    print("文件管理工具已安装")
else:
    print("文件管理工具未安装")</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">综合管理示例</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">完整工作流程</h4>
                            <p style="color: var(--text-secondary)">展示从生成到测试的完整AI MCP工具管理流程</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code># 1. 生成AI MCP工具
print("=== 生成AI MCP工具 ===")
result = mag.generate_mcp(
    requirement="创建一个时间管理工具，提供获取当前时间、时区转换、倒计时等功能",
    model_name="deepseek-chat"
)

if result["status"] == "success":
    tool_name = result["tool_name"]
    print(f"成功生成工具: {tool_name}")
    
    # 2. 连接新生成的工具
    print(f"\n=== 连接工具 {tool_name} ===")
    connect_result = mag.connect_mcp(tool_name)
    print(f"连接结果: {connect_result['status']}")
    
    # 3. 获取工具列表并测试
    if connect_result['status'] == 'connected':
        tools = connect_result.get('tools', [])
        print(f"可用工具: {tools}")
        
        # 4. 测试第一个工具（如果存在）
        if tools:
            first_tool = tools[0]
            print(f"\n=== 测试工具 {first_tool} ===")
            test_result = mag.test_mcp(tool_name, first_tool, {})
            print(f"测试结果: {test_result}")
    
    # 5. 列出所有AI工具
    print(f"\n=== 当前AI工具列表 ===")
    ai_tools = mag.list_ai_mcp()
    for tool in ai_tools:
        print(f"- {tool}")
        
else:
    print(f"生成失败: {result['error']}")

# 6. 获取当前MCP状态
print(f"\n=== MCP服务器状态 ===")
status = mag.get_mcp_status()
for server, info in status.items():
    connected = "✓" if info.get("connected") else "✗"
    tools_count = len(info.get("tools", []))
    print(f"{connected} {server}: {tools_count} 个工具")</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 图生成页面 -->
                <div id="graph-generate" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-magic mr-3 text-blue-600"></i>图生成
                    </h2>

                    <!-- 获取提示词模板 -->
                    <div class="method-card p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4">获取提示词模板</h3>
                        
                        <!-- 生成图提示词 -->
                        <div class="mb-6">
                            <h4 class="text-lg font-medium mb-2">mag.get_generate_prompt()</h4>
                            <div class="mb-4">
                                <h5 class="font-medium mb-2">方法签名</h5>
                                <div class="code-block p-4 mb-4">
                                    <pre><code class="language-python">mag.get_generate_prompt() -> str</code></pre>
                                </div>
                            </div>
                            <div class="mb-4">
                                <h5 class="font-medium mb-2">返回值</h5>
                                <p style="color: var(--text-secondary)">str: 包含工具信息和模型列表的提示词模板</p>
                            </div>
                            <div class="mb-4">
                                <h5 class="font-medium mb-2">使用示例</h5>
                                <div class="code-block p-4">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                        <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                            <i class="fas fa-copy mr-1"></i>复制
                                        </button>
                                    </div>
                                    <pre><code class="language-python">template = mag.get_generate_prompt()
print(template)</code></pre>
                                </div>
                            </div>
                        </div>

                        <!-- 优化图提示词 -->
                        <div>
                            <h4 class="text-lg font-medium mb-2">mag.get_optimize_prompt()</h4>
                            <div class="mb-4">
                                <h5 class="font-medium mb-2">方法签名</h5>
                                <div class="code-block p-4 mb-4">
                                    <pre><code class="language-python">mag.get_optimize_prompt(graph_name: str) -> Dict[str, Any]</code></pre>
                                </div>
                            </div>
                            <div class="mb-4">
                                <h5 class="font-medium mb-2">参数</h5>
                                <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                    <li><strong>graph_name</strong> (str): 要优化的图名称</li>
                                </ul>
                            </div>
                            <div class="mb-4">
                                <h5 class="font-medium mb-2">返回值</h5>
                                <p style="color: var(--text-secondary)">Dict[str, Any]: 包含优化提示词的字典</p>
                            </div>
                            <div class="mb-4">
                                <h5 class="font-medium mb-2">使用示例</h5>
                                <div class="code-block p-4">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                        <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                            <i class="fas fa-copy mr-1"></i>复制
                                        </button>
                                    </div>
                                    <pre><code class="language-python">template = mag.get_optimize_prompt("test").get("prompt")
print(template)</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- AI 生成图 -->
                    <div class="method-card p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4">AI 生成图</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code class="language-python">mag.generate_graph(requirement: str, model_name: str) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>requirement</strong> (str): 用户的图生成需求描述</li>
                                <li><strong>model_name</strong> (str): 要使用的AI模型名称</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, Any]: 生成结果，包含图名称、分析内容等</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code class="language-python">result = mag.generate_graph(
    requirement="创建一个能够搜索网络信息并生成报告的工作流",
    model_name="deepseek-chat"
)

if result["status"] == "success":
    print(f"成功生成图: {result['graph_name']}")
    print(f"AI分析: {result['analysis']}")
else:
    print(f"生成失败: {result['message']}")</code></pre>
                            </div>
                        </div>
                    </div>

                    <!-- AI 优化图 -->
                    <div class="method-card p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4">AI 优化图</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code class="language-python">mag.optimize(graph_name: str, optimization_requirement: str, model_name: str) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>graph_name</strong> (str): 要优化的图名称</li>
                                <li><strong>optimization_requirement</strong> (str): 优化需求描述</li>
                                <li><strong>model_name</strong> (str): 要使用的AI模型名称</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, Any]: 优化结果，包含原图名称、模型输出等</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code class="language-python">result = mag.optimize(
    graph_name="web_research_report_v2",
    optimization_requirement="优化这个图的性能，将图变得更加丰富（但不要增加不必要的节点），改进提示词质量（不要让提示词过长）",
    model_name="deepseek-chat"
)

if result["status"] == "success":
    print(f"成功生成图: {result['original_graph_name']}")
    print(f"AI输出: {result['model_output']}")
else:
    print(f"生成失败: {result['message']}")</code></pre>
                            </div>
                        </div>
                    </div>

                    <!-- 保存图 -->
                    <div class="method-card p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4">保存图</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code class="language-python">mag.save_graph(config: Dict[str, Any]) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>config</strong> (Dict): 图配置，包含name、description、nodes等字段</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, Any]: 操作结果</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code class="language-python">graph_config = {
    "name": "simple_assistant",
    "description": "简单的问答助手",
    "nodes": [
        {
            "name": "assistant",
            "description": "回答用户问题的助手",
            "model_name": "gpt-4",
            "system_prompt": "你是一个有用的助手，请回答用户的问题。",
            "user_prompt": "用户问题：{start}",
            "input_nodes": ["start"],
            "output_nodes": ["end"]
        }
    ]
}

result = mag.save_graph(graph_config)
print(f"保存结果: {result}")</code></pre>
                            </div>
                        </div>
                    </div>

                    <!-- 导入图 -->
                    <div class="method-card p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4">导入图</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code class="language-python">mag.import_graph(file_path: str) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>file_path</strong> (str): 文件路径 (.json 或 .zip)</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, Any]: 导入结果</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code class="language-python"># 从config导入
graph = mag.import_graph(r"deepsearch.json")
print(json.dumps(graph, indent=2, ensure_ascii=False))</code></pre>
                            </div>
                        </div>
                    </div>

                    <!-- 导出图 -->
                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">导出图</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code class="language-python">mag.export_graph(name: str) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>name</strong> (str): 图名称</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, Any]: 导出结果，包含导出文件路径</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code class="language-python">graph = mag.export_graph("news_processing_workflow")
print(json.dumps(graph, indent=2, ensure_ascii=False))</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 图查看页面 -->
                <div id="graph-view" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-eye mr-3 text-blue-600"></i>图查看
                    </h2>

                    <div class="method-card p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4">列出所有图</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.list_graphs() -> List[str]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">List[str]: 图名称列表</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code class="language-python">print("\n列出所有图:")
graphs = mag.list_graphs()
print(f"找到 {len(graphs)} 个图: {graphs}")</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="method-card p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4">获取图配置</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code class="language-python">mag.get_graph(name: str) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>name</strong> (str): 图名称</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code class="language-python">result = mag.get_graph('news_processing_workflow')
print(json.dumps(result, indent=2, ensure_ascii=False))</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="method-card p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4">获取图详情</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.get_graph_detail(name: str) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>name</strong> (str): 图名称</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, Any]: 包含图配置和README内容的字典</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>graph_detail = mag.get_graph_detail("deepresearch")</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">渲染README</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">说明</h4>
                            <p style="color: var(--text-secondary)">渲染图的README文档内容</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>graph_detail = mag.get_graph_detail("deepresearch")

# 渲染README
if graph_detail['readme']:
    display(Markdown(graph_detail['readme']))
else:
    print("未找到README文件")</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 图运行页面 -->
                <div id="graph-run" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-play mr-3 text-blue-600"></i>图运行
                    </h2>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">mag.run()</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.run(name: str, input_text: str, parallel: bool = False) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>name</strong> (str): 图名称</li>
                                <li><strong>input_text</strong> (str): 输入文本</li>
                                <li><strong>parallel</strong> (bool): 是否并行执行，默认为False</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, Any]: 执行结果，包含会话ID和输出</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>result = mag.run("deepresearch",input_text="深度探究mcp-agent-graph项目",parallel=False)
print(result)</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 断点续传页面 -->
                <div id="graph-continue" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-forward mr-3 text-blue-600"></i>断点续传
                    </h2>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">mag.continue_run()</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.continue_run(conversation_id: str, input_text: str = None, 
                parallel: bool = False, continue_from_checkpoint: bool = False) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>conversation_id</strong> (str): 会话ID</li>
                                <li><strong>input_text</strong> (str, optional): 新的输入文本，如果为None则从断点继续</li>
                                <li><strong>parallel</strong> (bool): 是否并行执行，默认为False</li>
                                <li><strong>continue_from_checkpoint</strong> (bool): 是否从断点继续，默认为False</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, Any]: 执行结果</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code># 首先运行一个图
initial_result = mag.run(
    "deepresearch", 
    "深度探究mcp-agent-graph项目",
    parallel=True
)
conversation_id = initial_result['conversation_id']

# 从断点继续（不添加新输入）
checkpoint_result = mag.continue_run(
    conversation_id=conversation_id,
    continue_from_checkpoint=True
)

print(f"断点继续结果: {checkpoint_result}")

# 重新开启会话，使用新输入
continue_result = mag.continue_run(
    conversation_id=conversation_id,
    input_text="深度探究mcp-agent-graph项目",
    parallel=False
)

print(f"继续执行结果: {continue_result}")</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 图转MCP页面 -->
                <div id="graph-to-mcp" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-code mr-3 text-blue-600"></i>图转MCP
                    </h2>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">mag.generate_mcp_script()</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.generate_mcp_script(name: str) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>name</strong> (str): 图名称</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, Any]: 生成的脚本内容</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>mcp = mag.generate_mcp_script("news_processing_workflow")
# 保存并行执行脚本
with open("news_workflow_parallel.py", "w", encoding="utf-8") as f:
    f.write(mcp["parallel_script"])

# 保存顺序执行脚本
with open("news_workflow_sequential.py", "w", encoding="utf-8") as f:
    f.write(mcp["sequential_script"])</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 会话列表页面 -->
                <div id="conversation-list" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-list mr-3 text-blue-600"></i>会话列表
                    </h2>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">mag.list_conversations()</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.list_conversations() -> List[str]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">List[str]: 会话ID列表</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>result = mag.list_conversations()
result</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 获取会话页面 -->
                <div id="conversation-get" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-eye mr-3 text-blue-600"></i>获取会话
                    </h2>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">mag.get_conversation()</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">方法签名</h4>
                            <div class="code-block p-4 mb-4">
                                <pre><code>mag.get_conversation(conversation_id: str) -> Dict[str, Any]</code></pre>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">参数</h4>
                            <ul class="list-disc list-inside space-y-1" style="color: var(--text-secondary)">
                                <li><strong>conversation_id</strong> (str): 会话ID</li>
                            </ul>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">返回值</h4>
                            <p style="color: var(--text-secondary)">Dict[str, Any]: 会话状态</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>result = mag.get_conversation('')

# 获取附件
attactments = result.get("attachments")
print(json.dumps(attactments, indent=2, ensure_ascii=False))</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 附件处理页面 -->
                <div id="conversation-attachments" class="page-content hidden">
                    <h2 class="text-3xl font-bold mb-6">
                        <i class="fas fa-paperclip mr-3 text-blue-600"></i>附件处理
                    </h2>

                    <div class="method-card p-6">
                        <h3 class="text-xl font-semibold mb-4">附件显示函数</h3>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">说明</h4>
                            <p style="color: var(--text-secondary)">显示附件内容，支持md、html文件</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">使用示例</h4>
                            <div class="code-block p-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-medium" style="color: var(--text-muted)">Python</span>
                                    <button class="copy-btn px-3 py-1 rounded text-sm" onclick="copyCode(this)">
                                        <i class="fas fa-copy mr-1"></i>复制
                                    </button>
                                </div>
                                <pre><code>def display_attachments(attachments):
    """
    显示附件内容，支持md、html文件,这里只提供demo，运行时产生其他扩展文件请自行设计。或直接前往目录查看。
    使用notebook的markdown进行展示
    
    参数:
    attachments - 附件列表
    """
    if not attachments:
        print("没有可显示的附件")
        return
    
    for attachment in attachments:
        file_type = attachment["type"].lower()
        file_path = attachment["path"]
        file_name = attachment["name"]
        
        # 跳过不支持的文件类型
        if file_type not in ["md", "html", "docx", "pdf"]:
            continue
            
        print(f"\n📄 {file_name} ({file_type.upper()}):")
        
        try:
            # Markdown文件 - 使用IPython的Markdown显示
            if file_type == "md":
                with open(file_path, 'r', encoding='utf-8') as f:
                    md_content = f.read()
                display(Markdown(md_content))
                
            # HTML文件 - 使用IPython的HTML显示，或在浏览器中打开
            elif file_type == "html":
                try:
                    webbrowser.open(file_path)
                except:
                    print(f"已在浏览器中打开 HTML 文件")
                
        except Exception as e:
            print(f"无法显示文件 {file_name}: {str(e)}")

display_attachments(attactments)</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 默认欢迎页面 -->
                <div id="welcome" class="page-content">
                    <div class="text-center">
                        <div class="mb-8">
                            <i class="fas fa-rocket text-6xl text-blue-600 mb-4"></i>
                            <h1 class="text-4xl font-bold mb-4">欢迎使用 MAG SDK</h1>
                            <p class="text-xl" style="color: var(--text-secondary)">MCP Agent Graph 开发框架 Python SDK</p>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-12">
                            <div class="section-card p-6 text-center">
                                <i class="fas fa-download text-3xl text-blue-600 mb-4"></i>
                                <h3 class="text-lg font-semibold mb-2">快速开始</h3>
                                <p class="text-sm" style="color: var(--text-muted)">了解如何安装和启动 MAG 服务</p>
                            </div>
                            
                            <div class="section-card p-6 text-center">
                                <i class="fas fa-brain text-3xl text-green-600 mb-4"></i>
                                <h3 class="text-lg font-semibold mb-2">模型管理</h3>
                                <p class="text-sm" style="color: var(--text-muted)">管理和配置 AI 模型</p>
                            </div>
                            
                            <div class="section-card p-6 text-center">
                                <i class="fas fa-server text-3xl text-purple-600 mb-4"></i>
                                <h3 class="text-lg font-semibold mb-2">MCP 管理</h3>
                                <p class="text-sm" style="color: var(--text-muted)">管理 MCP 服务器和工具</p>
                            </div>
                            
                            <div class="section-card p-6 text-center">
                                <i class="fas fa-project-diagram text-3xl text-red-600 mb-4"></i>
                                <h3 class="text-lg font-semibold mb-2">图管理</h3>
                                <p class="text-sm" style="color: var(--text-muted)">创建和执行 Agent 图</p>
                            </div>
                            
                            <div class="section-card p-6 text-center">
                                <i class="fas fa-comments text-3xl text-yellow-600 mb-4"></i>
                                <h3 class="text-lg font-semibold mb-2">会话管理</h3>
                                <p class="text-sm" style="color: var(--text-muted)">管理对话和附件</p>
                            </div>
                            
                            <div class="section-card p-6 text-center">
                                <i class="fas fa-code text-3xl text-indigo-600 mb-4"></i>
                                <h3 class="text-lg font-semibold mb-2">API 参考</h3>
                                <p class="text-sm" style="color: var(--text-muted)">完整的 API 文档和示例</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Highlight.js 语法高亮脚本 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/bash.min.js"></script>

    <script>
        // 主题切换功能
        function initTheme() {
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const savedTheme = localStorage.getItem('theme');
            const theme = savedTheme || (prefersDark ? 'dark' : 'light');
            
            document.documentElement.setAttribute('data-theme', theme);
            updateThemeIcon(theme);
            updateHighlightTheme(theme);
        }

        function toggleTheme() {
            const current = document.documentElement.getAttribute('data-theme');
            const newTheme = current === 'dark' ? 'light' : 'dark';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
            updateHighlightTheme(newTheme);
        }

        function updateThemeIcon(theme) {
            const icon = document.querySelector('#themeToggle i');
            icon.className = theme === 'dark' ? 'fas fa-sun text-sm' : 'fas fa-moon text-sm';
        }

        function updateHighlightTheme(theme) {
            const highlightTheme = document.getElementById('highlight-theme');
            if (theme === 'dark') {
                highlightTheme.href = 'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css';
            } else {
                highlightTheme.href = 'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css';
            }
        }

        // 侧边栏折叠功能
        function toggleSection(sectionId) {
            const content = document.getElementById(sectionId + '-content');
            const icon = document.getElementById(sectionId + '-icon');
            
            content.classList.toggle('expanded');
            icon.style.transform = content.classList.contains('expanded') ? 'rotate(180deg)' : 'rotate(0deg)';
        }

        // 代码复制功能
        function copyCode(button) {
            const codeBlock = button.closest('.code-block');
            const code = codeBlock.querySelector('code');
            const text = code.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                const originalText = button.innerHTML;
                button.innerHTML = '<i class="fas fa-check mr-1"></i>已复制';
                button.style.backgroundColor = '#10b981';
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.style.backgroundColor = '';
                }, 2000);
            });
        }

        // 页面切换时重新应用语法高亮
        function showPage(pageId) {
            // 隐藏所有页面
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.add('hidden');
                page.classList.remove('fade-in');
            });
            
            // 显示目标页面
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.remove('hidden');
                targetPage.classList.add('fade-in');
                
                // 重新应用语法高亮到新显示的页面
                setTimeout(() => {
                    targetPage.querySelectorAll('pre code').forEach((block) => {
                        hljs.highlightElement(block);
                    });
                }, 100);
            }

            // 更新导航状态
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            if (event && event.target) {
                event.target.classList.add('active');
            }
        }

        // 事件监听器
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化代码高亮
            hljs.highlightAll();
            
            initTheme();
            
            // 默认展开第一个部分
            toggleSection('quick-start');
            
            // 主题切换按钮
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);
            
            // 监听系统主题变化
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                if (!localStorage.getItem('theme')) {
                    const theme = e.matches ? 'dark' : 'light';
                    document.documentElement.setAttribute('data-theme', theme);
                    updateThemeIcon(theme);
                    updateHighlightTheme(theme);
                }
            });

            // 默认显示欢迎页面
            showPage('welcome');
        });
    </script>
</body>
</html>