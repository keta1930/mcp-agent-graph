# Sub-agent（子智能体）

让智能体自动将复杂任务分解并分配给专业智能体处理。

**执行流程：**

1. 接收复杂请求
2. 自动分解为专业子任务
3. 为每个子任务分配任务 ID 并指派专家
4. 专家在独立环境中完成工作，通过文件传递成果
5. 汇总所有结果并返回

## 关键特性

### 独立执行环境

每个subagent执行子任务在独立环境中完成：
- 不同任务互不干扰，保持专注
- 专家只处理自己领域的工作
- 协调智能体保持清晰的全局视角

### 任务历史记录

任务 ID 实现完整的执行追踪：
- 相同 ID = 继续之前的任务，保留所有历史
- 不同 ID = 开始全新任务
- 支持迭代优化和多轮改进

### 专家协作机制

多个专家按需协作：
- 每个专家配备专门的能力和工具
- 通过文件传递工作成果
- 分工明确，协作高效

## 应用示例

### 代码审查流程

| 阶段 | 执行者 | 工作内容 |
|------|--------|---------|
| 1. 初审 | 代码审查员 | 检查代码质量，输出审查报告 |
| 2. 修复 | 开发智能体 | 根据报告修复问题，记录修改内容 |
| 3. 复审 | 代码审查员（相同任务 ID） | 验证修复效果，确认或提出新建议 |

### 研究分析流程

| 阶段 | 执行者 | 工作内容 |
|------|--------|---------|
| 1. 调研 | 研究智能体 | 收集相关信息和资料 |
| 2. 分析 | 数据分析师 | 分析调研结果，提取关键信息 |
| 3. 报告 | 写作智能体 | 整理分析结果，生成专业报告 |

### 迭代优化流程

| 轮次 | 执行者 | 任务 ID | 工作内容 |
|------|--------|---------|---------|
| 1 | 写作智能体 | `doc-v1` | 创建初稿 |
| 2 | 写作智能体 | `doc-v1` | 根据反馈修改（保留初稿上下文） |
| 3 | 写作智能体 | `doc-v1` | 最终润色（包含所有历史） |

## 配合文件工具使用

Sub-agent 配合文件工具实现高效协作：

**成果输出：**
专家完成工作后将结果保存到文件（如 `analysis_report.md`）

**信息传递：**
下一个专家读取文件获取前序工作成果

**协作流程：**
专家 A 输出文件 → 专家 B 读取并处理 → 专家 B 输出新文件

**优势：**
- 工作成果清晰可见
- 完整的版本历史记录
- 便于追溯和审查

## 配置建议

为获得最佳效果，建议：

| 配置项 | 建议 |
|--------|------|
| **智能体指令** | 明确专业领域和职责范围 |
| **工具配置** | 配备文件工具和领域专用工具 |
| **命名规范** | 使用清晰的名称和标签便于识别 |
| **执行限制** | 根据任务复杂度合理设置 `max_actions` |

## 相关文档

- [文件工具](file-tool.zh.md) - 实现专家之间的工作交接
- [Agent 配置](../agent/config.zh.md) - 配置专家能力
- [多 Agent 系统](../agent/multi-agent.zh.md) - 协调模式
