# MCP Builder（MCP 构建器）

让 Agent 通过 FastMCP 框架引导式开发，设计并创建自定义 MCP 工具服务器。

## 核心能力

MCP Builder 通过 AI 协作提供完整的 MCP 服务器开发：

| 能力 | 优势 | 示例 |
|------|------|------|
| **需求收集** | Agent 提出明确问题，理解工具需求 | 用户说"天气 API 工具" → Agent 询问数据源、API 密钥、功能需求 |
| **开发指导** | 提供完整的 FastMCP 规范，包含示例和最佳实践 | 学习如何使用 FastMCP 装饰器、定义工具、处理错误 |
| **配置文档化** | 工具设计存储为带结构化 XML 标签的 Markdown 文件 | `mcp/weather_api.md` 包含 `<folder_name>`、`<script_file>`、`<dependencies>` 标签 |
| **自动化设置** | 解析设计文档，创建工具文件夹、安装依赖、配置虚拟环境 | 从文档 → 可用的 MCP 服务器 |
| **迭代优化** | 根据反馈修改设计，直至满意 | 草案 → 用户反馈 → 调整 → 重复直至完美 |

## 为什么使用 MCP Builder

- 自然语言对话设计工具
- Agent 询问问题理解需求
- 提供 FastMCP 规范和模板
- 自动创建工具、安装依赖、注册
- 基于反馈迭代改进

**协作模式：**

1. 用户以自然语言表达需求
2. Agent 询问明确问题（API 来源、功能、需求）
3. 获取 FastMCP 规范理解框架
4. 设计工具代码和配置
5. 创建带结构化 XML 标签的 Markdown 文件
6. 用户提供反馈，Agent 调整设计
7. 重复直至用户批准
8. 注册工具 - 自动设置和配置

## 可用操作

| 操作 | 用途 | 使用时机 |
|------|------|---------|
| `get_mcp_spec` | 获取完整的 FastMCP 开发规范 | 开始新 MCP 工具设计，了解框架 |
| `register_mcp` | 解析工具文档并注册到系统 | 用户批准最终设计后 |

**注意：** MCP Builder 与文件工具协作，创建/编辑工具配置文档。

## 常见工作流

### 创建新 MCP 工具

| 阶段 | 操作 | 详情 |
|------|------|------|
| 1. 需求确认 | Agent 提问 | "访问哪些数据/服务？"、"需要 API 密钥吗？"、"输入/输出格式？" |
| 2. 获取规范 | 获取开发指南 | `get_mcp_spec` 检索 FastMCP 示例、模板、XML 标签说明 |
| 3. 设计 | 起草工具代码 | Agent 使用 FastMCP 设计工具函数、参数、错误处理 |
| 4. 文档化 | 创建结构化文件 | `create_file("mcp/weather.md", ...)` 包含 `<folder_name>`、`<script_file>`、`<dependencies>`、`<readme>` 标签 |
| 5. 评审 | 用户检查设计 | Agent 解释实现，用户提供反馈 |
| 6. 优化 | 基于反馈迭代 | 用户："添加缓存" → Agent 使用 `update_file` 更新 |
| 7. 注册 | 设置并激活 | `register_mcp("mcp/weather.md")` → 创建文件夹、安装包、注册服务器 |

### 优化现有工具

| 阶段 | 操作 | 详情 |
|------|------|------|
| 1. 导出 | 获取当前配置 | 用户或 Agent 从 `mcp/` 目录读取现有工具文档 |
| 2. 评审 | 用户确定更改 | "添加重试逻辑"、"支持更多数据格式" |
| 3. 修改 | 更新代码 | Agent 使用 `update_file` 或 `rewrite_file` 编辑 Markdown 文件 |
| 4. 优化 | 迭代直至满意 | 多轮用户反馈和调整 |
| 5. 更新 | 重新注册 | `register_mcp("mcp/tool_name.md")` → 更新工具新版本 |

## 人机协作

### Agent 的职责

- 在设计前询问明确问题
- 清晰解释 FastMCP 概念
- 注册前呈现草案供评审
- 倾听反馈并相应调整
- 确保用户满意后再最终确定

## 与其他工具集成

**+ 文件工具：** MCP 工具配置是通过文件操作管理的 Markdown 文件
- `create_file` 创建初始设计
- `read_file` 评审当前配置
- `update_file` 针对性修改（小调整）
- `rewrite_file` 大规模修订（重构）

**+ 系统操作：** 创建后，工具在系统范围内可用
- `list_all_mcps` 查看已注册工具
- `get_mcp_details` 查看工具信息

## 最佳使用场景

**适合用于：**
- 连接外部 API（搜素、数据库）
- 自定义数据处理工具
- 特定领域集成
- 用专门功能扩展 Agent 能力

## 相关文档

- [文件工具](file-tool.zh.md) - 管理 MCP 工具配置文件
- [MCP 概念](../mcp/index.zh.md) - 理解 MCP 协议
- [系统操作](system-operations.zh.md) - 管理已注册工具
