# Graph 执行

Graph 按层级逐层执行节点。

## 执行流程

```mermaid
graph TB
    A[用户输入] --> B[层级 0: start]
    B --> C[层级 1: 节点 A, B]
    C --> D[层级 2: 节点 C]
    D --> E[返回结果]
```

**执行规则：**
- 同一层级的节点按顺序执行
- 每个节点等待上游节点完成
- 节点接收上游输出作为输入

## 执行模式

| 模式 | 响应方式 | 适用场景 |
|------|---------|---------|
| **流式** | 每个节点流式输出内容 | 交互式任务 |
| **后台** | 立即返回会话 ID | 长时间任务 |

## Handoffs 执行

带 Handoffs 的节点可以动态选择下一步：

```mermaid
graph LR
    A[节点执行] --> B{选择下一个节点}
    B -->|选择节点 X| C[执行节点 X]
    B -->|达到限制| D[继续下一层级]
    C --> B
```

每个 Handoffs 节点有选择次数限制，达到限制后自动继续正常流程。

## 最终输出

| 方式 | 说明 |
|------|------|
| **使用模板** | 配置 `end_template`，用 `{{节点名}}` 引用节点输出 |
| **最后节点** | 使用最后执行节点的输出 |

## 下一步

- **[Graph 配置](config.zh.md)** - 了解如何配置 Graph
- **[Handoffs](handoffs.zh.md)** - 实现动态路由
- **[子图](subgraph.zh.md)** - 构建模块化工作流
